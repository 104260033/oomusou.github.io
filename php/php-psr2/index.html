<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>PSR-2 PHP Coding Style | 點燈坊</title>
  <meta name="author" content="真 OO無双">
  
  <meta name="description" content="PHP Coding Style與工具整理">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
 <meta name="description" content="PHP Coding Style與工具整理">
<meta property="og:type" content="article">
<meta property="og:title" content="PSR-2 PHP Coding Style">
<meta property="og:url" content="http://oomusou.io/php/php-psr2/index.html">
<meta property="og:site_name" content="點燈坊">
<meta property="og:description" content="PHP Coding Style與工具整理">
<meta property="og:image" content="http://oomusou.io/images/feature/logo.png">
<meta property="og:updated_time" content="2016-03-22T14:03:51.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PSR-2 PHP Coding Style">
<meta name="twitter:description" content="PHP Coding Style與工具整理">
 

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">點燈坊</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 
	
		<div class="page-header">		
			<h1> PSR-2 PHP Coding Style</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

	
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> PHP Coding Style與工具整理			
		</div> <!-- alert -->
		

	<!-- toc -->
	<div id="postTOC">
		<span class="tocHeading">Contents</span>
		<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#PHP-FIG"><span class="toc-article-text">PHP-FIG</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Framework之間互相合作"><span class="toc-article-text">Framework之間互相合作</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Interface"><span class="toc-article-text">Interface</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Autoloading"><span class="toc-article-text">Autoloading</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Coding_Style"><span class="toc-article-text">Coding Style</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#PSR"><span class="toc-article-text">PSR</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#PSR-2_Coding_Style"><span class="toc-article-text">PSR-2 Coding Style</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#縮排"><span class="toc-article-text">縮排</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#每行字數"><span class="toc-article-text">每行字數</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#PHP標籤"><span class="toc-article-text">PHP標籤</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#字元編碼"><span class="toc-article-text">字元編碼</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Function"><span class="toc-article-text">Function</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Namespace"><span class="toc-article-text">Namespace</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Class"><span class="toc-article-text">Class</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Interface-1"><span class="toc-article-text">Interface</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Trait"><span class="toc-article-text">Trait</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Constant"><span class="toc-article-text">Constant</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Property"><span class="toc-article-text">Property</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Method"><span class="toc-article-text">Method</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Method_and_Function_Calls"><span class="toc-article-text">Method and Function Calls</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Closure"><span class="toc-article-text">Closure</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#if_else_elseif"><span class="toc-article-text">if else elseif</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#switch_case"><span class="toc-article-text">switch case</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#while"><span class="toc-article-text">while</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#do_while"><span class="toc-article-text">do while</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#for"><span class="toc-article-text">for</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#foreach"><span class="toc-article-text">foreach</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#try_catch"><span class="toc-article-text">try catch</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#輔助工具"><span class="toc-article-text">輔助工具</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#phpcs"><span class="toc-article-text">phpcs</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#php-cs-fixer"><span class="toc-article-text">php-cs-fixer</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#PhpStorm"><span class="toc-article-text">PhpStorm</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Conclusion"><span class="toc-article-text">Conclusion</span></a></li></ol>
    </div>

	<!-- content -->
	<div class="mypage">		
	    <p>相較於其他Web後端技術，PHP的一大特色是有眾多framework支援，有macro framework如Symfony與Laravel，也有micro framework如Silex與Slim，更有較早期的CodeIgniter。</p>
<p>PHP的各framework蓬勃發展是一種良性競爭，但也導致各framework一直在重新製造輪子。若能讓PHP的framework各展所長，彼此互相合作，就必須大家遵守一個共同的標準，這就是<code>PHP-FIG</code>的<code>PSR</code>。</p>
<a id="more"></a>
<h2 id="PHP-FIG">PHP-FIG</h2><hr>
<p>為了解決這個問題，PHP各framework代表在2009年建立了PHP-FIG (<strong>PHP Framework Interop Group</strong>)，目的在建立各framework所遵守得共同標準，讓彼此可以互相合作。</p>
<h2 id="Framework之間互相合作">Framework之間互相合作</h2><hr>
<p>各framework要能互相合作使用，有3個前提必須遵守。</p>
<h3 id="Interface">Interface</h3><p>各framework藉由使用相同的interface，達成互相合作。因為只要該framework實作相同的interface，別的framework就可拿來使用。</p>
<p>如寫log的功能，各大framework都需要，為了不讓每個framework重新製造輪子，只要有人實踐<code>emergency()</code>, <code>alert()</code>, <code>critical()</code>, <code>error()</code>, <code>warning()</code>, <code>notice()</code>, <code>info()</code>, 與<code>debug()</code>這樣interface的物件，其他framework都可以拿來用，而不用在乎它是哪個framework所提供的或如何實作。<span class="margin-note-marker"><sup>1</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">1</span>事實上這就是PSR-3。</span></span></span></p>
<h3 id="Autoloading">Autoloading</h3><p>各framework藉由使用相同的方法載入物件，達成互相合作。因為各framework底層載入物件的方式相同，只要同一套autoloader就能載入各framework的物件。</p>
<p>在此之前，各framework各自實作自己的autoloader，有的使用<code>\_autoload()</code>，有的使用<code>spl_autoload_register()</code>，導致每用一套framework，就必須去熟悉其autoloader。<span class="margin-note-marker"><sup>2</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">2</span>事實上這就是PSR-4。</span></span></span></p>
<h3 id="Coding_Style">Coding Style</h3><p>各framework藉由使用相同的coding style，達成互相合作。因為大家使用相同的coding style，可以更容易的去trace其他framwork的code，而不用去學習新的coding style。</p>
<p>相同的coding style對於一個團隊也是很有幫助，假如每個成員都有自己的coding style，要去trace或了解其他成員的code將更花時間，也更難達成<code>code review</code>的目的。這也是本文希望藉由PHP-FIG的<code>PSR-2</code>來統一團隊成員中的coding style的原因。</p>
<h2 id="PSR">PSR</h2><hr>
<p><strong><em>PSR</em></strong>是<strong><em>PHP Standard Recommendation</em></strong>的縮寫，對於各framework都會遇到的問題，PSR提出建議的解決方案，而非各framework不斷各自解決相同的問題。</p>
<p>目前已經正式提出的PSR如下 : </p>
<ol>
<li><a href="http://www.php-fig.org/psr/psr-1/" target="_blank" rel="external">PSR-1: Basic coding style</a></li>
<li><a href="http://www.php-fig.org/psr/psr-2/" target="_blank" rel="external">PSR-2: Strict coding style</a></li>
<li><a href="http://www.php-fig.org/psr/psr-3/" target="_blank" rel="external">PSR-3: Logger interface</a></li>
<li><a href="http://www.php-fig.org/psr/psr-4/" target="_blank" rel="external">PSR-4: Autoloading</a></li>
<li><a href="http://www.php-fig.org/psr/psr-7/" target="_blank" rel="external">PSR-7: HTTP message interface</a></li>
</ol>
<h2 id="PSR-2_Coding_Style">PSR-2 Coding Style</h2><hr>
<p>PSR-1定義出PHP應該遵守的<code>最基本</code>coding style，PSR-2則以PSR-1為基礎定義出更嚴格的建議。以下整理出PSR-1與PSR-2所建議的coding style。</p>
<h3 id="縮排">縮排</h3><p>使用<code>4個space</code>，<code>不要</code>使用<code>tab</code>。</p>
<h3 id="每行字數">每行字數</h3><p>建議在每行<code>80</code>個字左右，最多不要超過<code>120</code>個字。</p>
<h3 id="PHP標籤">PHP標籤</h3><ul>
<li>PHP必須使用<code>&lt;?php ?&gt;</code>或<code>&lt;?= ?&gt;</code>，不可以使用其他標籤。</li>
<li>若PHP不包含HTML，則不用使用結束標籤<code>?&gt;</code>。</li>
</ul>
<h3 id="字元編碼">字元編碼</h3><p>PHP必須使用無<code>BOM</code>的<code>UTF-8</code>編碼。<span class="margin-note-marker"><sup>3</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">3</span>雖然看起來很複雜，但不用擔心，一般文字編輯器或IDE會幫你處理。</span></span></span></p>
<h3 id="Function">Function</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span><span class="params">(<span class="variable">$arg1</span>, <span class="variable">$arg2</span> = <span class="string">'Hi'</span>)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$arg1</span> . <span class="variable">$arg2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span><span class="params">(</span><br><span class="line">    <span class="variable">$arg1</span>,</span><br><span class="line">    <span class="variable">$arg2</span> = <span class="string">'Hi'</span></span><br><span class="line">)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$arg1</span> . <span class="variable">$arg2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>camelCase</code>。</li>
<li><code>{</code>必須<code>換行</code>。</li>
<li><code>Function名稱</code>與<code>(</code>之間<code>不要留空白</code>。</li>
<li>參數的<code>,</code>之<code>前</code> <code>不可以有空白</code>，而<code>,</code>之<code>後</code>需留<code>一個空白</code>。</li>
<li>參數列若提供<code>預設值</code>，則必須放在<code>最後一個</code>參數。</li>
<li>參數列允許多行寫法，第一個參數要在<code>新的一行</code>，且每一行只有<code>一個參數</code>。</li>
<li>參數列的結束<code>)</code>要在<code>新的一行</code>，且與<code>)</code>與<code>{</code>同行，之間要留<code>一個空白</code>。</li>
</ul>
<h3 id="Namespace">Namespace</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Package</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">FooInterface</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">BarClass</span> <span class="title">as</span> <span class="title">Bar</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">OtherVendor</span>\<span class="title">OtherPackage</span>\<span class="title">BazClass</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span> </span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>CamelCase</code>命名。</li>
<li><code>namespace</code>與<code>&lt;?php</code>之間需<code>空一行</code>。</li>
<li><code>namespace</code>宣告與<code>use</code>之間需<code>空一行</code>，<code>use</code>與<code>class</code>之間<code>再空一行</code>。</li>
<li>最上層namespace使用<code>公司名稱</code>。</li>
<li>每個class都要使用namespace，最少搭配一層namespace。</li>
</ul>
<h3 id="Class">Class</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChildClass</span> <span class="keyword">extends</span> <span class="title">ParentClass</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImplClass</span> <span class="keyword">implements</span> <span class="title">ContractInterface</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImpClass</span> <span class="keyword">implements</span> </span><br><span class="line">    <span class="title">FirstInterface</span>,</span><br><span class="line">    <span class="title">SecondInterface</span>,</span><br><span class="line">    <span class="title">ThirdInterface</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>CamelCase</code>命名。</li>
<li>一個class一個檔案。</li>
<li><code>extends</code>與<code>implements</code>需與class<code>同一行</code>。</li>
<li>括號<code>{</code>必須<code>換新的一行</code>。</li>
<li><code>implements</code>的interface允許多行寫法，第一個interface要在<code>新的一行</code>，且每一行只有<code>一個interface</code>。</li>
</ul>
<h3 id="Interface-1">Interface</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PostRepositoryInterface</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLatest3Posts</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>CamelCase</code>命名。</li>
<li>一個interface一個檔案。</li>
<li>括號<code>{</code>必須<code>換新的一行</code>。</li>
</ul>
<h3 id="Trait">Trait</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">trait</span> LogTrait</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">startLog</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        (略)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">stopLog</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        (略)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>CamelCase</code>命名。</li>
<li>一個trait一個檔案。</li>
<li>括號<code>{</code>必須<code>換新的一行</code>。</li>
</ul>
<h3 id="Constant">Constant</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION = <span class="string">'1.0'</span>;</span><br><span class="line">    <span class="keyword">const</span> DATE_APPROVED = <span class="string">'2012-06-01'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>全大寫</code>命名。</li>
<li>單字間以<code>_</code>隔開。</li>
</ul>
<h3 id="Property">Property</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$userName</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="variable">$userCountry</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$userPassword</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$userAddr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>camelCase</code>命名。<span class="margin-note-marker"><sup>4</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">4</span>PSR-1並沒有對property做明確規定要使用<code>camelCase</code>，只要求整個project或package風格統一即可，Laravel使用的是<code>camelCase</code>，若只有一個單字則使用小寫。</span></span></span></li>
<li>必須加上visibility (<code>public</code>, <code>protected</code>, <code>private</code>)。</li>
<li><code>static</code>必須加在visibility之<code>後</code>。</li>
<li><code>不要</code>再使用<code>var</code>宣告public property。</li>
<li><code>不要</code>再使用<code>_</code>宣告protected或private property。</li>
</ul>
<h3 id="Method">Method</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleClass</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">displayName</span><span class="params">()</span> </span><br><span class="line">    </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">sendMessage</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        ...	</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sendEmail</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">    	...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">sendSMS</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">    	...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">sendJson</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">    	...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">singleLineArgument</span><span class="params">(<span class="variable">$arg1</span>, &amp;<span class="variable">$arg2</span>, array <span class="variable">$arg3</span> = [])</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">multiLineArgument</span><span class="params">(</span><br><span class="line">        <span class="variable">$arg1</span>,</span><br><span class="line">        &amp;<span class="variable">$arg2</span>,</span><br><span class="line">        array <span class="variable">$arg3</span> = []</span><br><span class="line">    )</span> </span>&#123;</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>camelCase</code>命名。</li>
<li><code>{</code>必須<code>換新的一行</code>。</li>
<li>必須加上visibility (<code>public</code>, <code>protected</code>, <code>private</code>)。</li>
<li><code>abstract</code>與<code>final</code>必須加在visibility之<code>前</code>。</li>
<li><code>static</code>必須加在visibility之<code>後</code>。</li>
<li>不要再使用<code>_</code>宣告protected或private method。</li>
<li><code>Method名稱</code>與<code>(</code>之間<code>不要留空白</code>。</li>
<li>第一個<code>(</code>之<code>後</code> <code>不可以有空白</code>，最後一個<code>)</code>之<code>前</code> <code>不可以有空白</code>。</li>
<li>參數的<code>,</code>之<code>前</code> <code>不可以</code>有<code>空白</code>，而<code>,</code>之<code>後</code>需留<code>一個空白</code>。</li>
<li>參數列若提供<code>預設值</code>，則必須放在<code>最後一個</code>參數。</li>
<li>參數列允許多行寫法，第一個參數要在<code>新的一行</code>，且每一行只有<code>一個參數</code>。</li>
<li>參數列的結束<code>)</code>要在<code>新的一行</code>，且與<code>)</code>與<code>{</code>同行，之間要留<code>一個空白</code>。</li>
</ul>
<h3 id="Method_and_Function_Calls">Method and Function Calls</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func();</span><br><span class="line"><span class="variable">$foo</span>-&gt;method1(<span class="variable">$arg1</span>);</span><br><span class="line">Foo::method2(<span class="variable">$arg2</span>, <span class="variable">$arg3</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$foo</span>-&gt;method3(</span><br><span class="line">    <span class="variable">$arg1</span>,</span><br><span class="line">    <span class="variable">$arg2</span>,</span><br><span class="line">    <span class="variable">$arg3</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Method或function名稱</code>與<code>(</code>之間<code>不可以有空白</code>。</li>
<li>第一個<code>(</code>之<code>後</code> <code>不可以有空白</code>，最後一個<code>)</code>之<code>前</code> <code>不可以有空白</code>。</li>
<li>每個<code>,</code>之前不可以有<code>空白</code>，每個<code>,</code>之後需留一個<code>空白</code>。</li>
<li>引數列允許多列寫法，第一個引數要在<code>新的一行</code>，且每一行只有<code>一個引數</code>。</li>
<li>參數列的結束<code>)</code>要在<code>新的一行</code>。</li>
</ul>
<h3 id="Closure">Closure</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$closureWithArgs</span> = <span class="function"><span class="keyword">function</span> <span class="params">(<span class="variable">$arg1</span>, <span class="variable">$arg2</span>)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// body</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$closureWithArgsAndVars</span> = <span class="function"><span class="keyword">function</span> <span class="params">(<span class="variable">$arg1</span>, <span class="variable">$arg2</span>)</span> <span class="title">use</span> <span class="params">(<span class="variable">$var1</span>, <span class="variable">$var2</span>)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// body</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>function</code>與<code>(</code>之間需留<code>一個空白</code>。</li>
<li><code>use</code>前後都需要留<code>一個空白</code>。</li>
<li><code>{</code>必須與<code>function</code> <code>同一行</code>。<span class="margin-note-marker"><sup>5</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">5</span>Function與method是要求<code>{</code>必須換新的一行，但closure要求<code>{</code>與<code>function</code>在同一行。</span></span></span></li>
<li>第一個<code>(</code>之<code>後</code> <code>不可以有空白</code>，最後一個<code>)</code>之<code>前</code> <code>不可以有空白</code>。</li>
<li>參數的<code>,</code>之前<code>不可以</code>有<code>空白</code>，而<code>,</code>之後需留一個<code>空白</code>。</li>
<li>參數列若提供<code>預設值</code>，則必須放在<code>最後一個</code>參數。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cl1</span> = <span class="function"><span class="keyword">function</span> <span class="params">(</span><br><span class="line">    <span class="variable">$arg1</span>,</span><br><span class="line">    <span class="variable">$arg2</span>,</span><br><span class="line">    <span class="variable">$arg3</span></span><br><span class="line">)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cl2</span> = <span class="function"><span class="keyword">function</span> <span class="params">()</span> <span class="title">use</span> <span class="params">(</span><br><span class="line">    <span class="variable">$var1</span>,</span><br><span class="line">    <span class="variable">$var2</span>,</span><br><span class="line">    <span class="variable">$var3</span></span><br><span class="line">)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$cl3</span> = <span class="function"><span class="keyword">function</span> <span class="params">(</span><br><span class="line">    <span class="variable">$arg1</span>,</span><br><span class="line">    <span class="variable">$arg2</span>,</span><br><span class="line">    <span class="variable">$arg3</span></span><br><span class="line">)</span> <span class="title">use</span> <span class="params">(<span class="variable">$var1</span>)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cl4</span> = <span class="function"><span class="keyword">function</span> <span class="params">(<span class="variable">$arg1</span>)</span> <span class="title">use</span> <span class="params">(</span><br><span class="line">    <span class="variable">$var1</span>,</span><br><span class="line">    <span class="variable">$var2</span>,</span><br><span class="line">    <span class="variable">$var3</span></span><br><span class="line">)</span> </span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cl5</span> = <span class="function"><span class="keyword">function</span> <span class="params">(</span><br><span class="line">    <span class="variable">$arg1</span>,</span><br><span class="line">    <span class="variable">$arg2</span>,</span><br><span class="line">    <span class="variable">$arg3</span></span><br><span class="line">)</span> <span class="title">use</span> <span class="params">(</span><br><span class="line">    <span class="variable">$var1</span>,</span><br><span class="line">    <span class="variable">$var2</span>,</span><br><span class="line">    <span class="variable">$var3</span></span><br><span class="line">)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>參數列允許多行寫法，第一個參數要在<code>新的一行</code>，且每一行只有<code>一個參數</code>。</li>
<li>參數列的結束括號要在<code>新的一行</code>，且與<code>)</code>與<code>{</code>同行，之間要留<code>一個空白</code>。</li>
</ul>
<h3 id="if_else_elseif">if else elseif</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$expr1</span>) &#123;</span><br><span class="line">    <span class="comment">// if body</span></span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="variable">$expr2</span>) &#123;</span><br><span class="line">    <span class="comment">// elseif body</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// else body;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>if</code>, <code>elseif</code>, <code>else</code>要在<code>同一行</code>，不用換行。</li>
<li><code>}</code>與<code>elseif</code>要在<code>同一行</code>，不用換行。</li>
<li><code>}</code>與<code>else</code>要在<code>同一行</code>，不用換行。</li>
</ul>
<h3 id="switch_case">switch case</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (<span class="variable">$expr</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'First case, with a break'</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Second case, which falls through'</span>;</span><br><span class="line">        <span class="comment">// no break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Third case, return instead of break'</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Default case'</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>switch</code>在<code>同一行</code>。</li>
<li><code>case</code>後的條件與<code>:</code>之間<code>不可以有空白</code>。</li>
<li><code>case</code>必須縮排於<code>switch</code>，而<code>break</code>必須縮排於<code>case</code>。</li>
<li>PHP允許<code>case</code>內沒有<code>break</code>，但需在第一個<code>case</code>    加上<code>//no break</code>註解。</li>
</ul>
<h3 id="while">while</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="variable">$expr</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>while</code>在<code>同一行</code>。</li>
</ul>
<h3 id="do_while">do while</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="variable">$expr</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>do</code>與<code>{</code>在<code>同一行</code>。</li>
<li><code>}</code>與<code>while</code>在<code>同一行</code>.</li>
</ul>
<h3 id="for">for</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>for</code>在<code>同一行</code>。</li>
<li><code>=</code>、<code>&lt;</code>或<code>&gt;</code>前後要留<code>一個空白</code>。</li>
<li><code>;</code>之前<code>不可以有空白</code>，之後要留<code>一個空白</code>。</li>
<li>第一個<code>(</code>之<code>後</code> <code>不可以有空白</code>，最後一個<code>)</code>之<code>前</code> <code>不可以有空白</code>。</li>
</ul>
<h3 id="foreach">foreach</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="variable">$iterable</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>foreach</code>在<code>同一行</code>。</li>
<li><code>=&gt;</code>前後要留<code>一個空白</code>。</li>
<li>第一個<code>(</code>之<code>後</code> <code>不可以有空白</code>，最後一個<code>)</code>之<code>前</code> <code>不可以有空白</code>。</li>
</ul>
<h3 id="try_catch">try catch</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">catch</span> (FirstExceptionType <span class="variable">$e</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">catch</span> (OtherExceptionType <span class="variable">$e</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>{</code>與<code>try</code>, <code>catch</code>要在<code>同一行</code>，不用換行。</li>
<li><code>}</code>與<code>catch</code>要在<code>同一行</code>，不用換行。</li>
<li><code>}</code>與<code>finally</code>要在<code>同一行</code>，不用換行。</li>
</ul>
<h2 id="輔助工具">輔助工具</h2><hr>
<p>PSR-2只是個標準，但實務上還是要搭配好用的工具來完成。</p>
<h3 id="phpcs">phpcs</h3><p><a href="http://pear.php.net/package/PHP_CodeSniffer/" target="_blank" rel="external">PHP Code Sniffer</a>簡稱 <strong><em>phpcs</em></strong>，用來檢查你寫的PHP是否符合PSR-2，若完全符合則沒有任何結果，若有任何錯誤將顯示錯誤報告。這適合幫我們檢查Legacy PHP是否符合PSR-2。<span class="margin-note-marker"><sup>6</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">6</span>將PHP Code Sniffer安裝到Homestead或Mac本機都可以，安裝方式都一樣，若要搭配PhpStorm就要<code>一定</code>要安裝在Mac本機。</span></span></span></p>
<p><strong>安裝</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ composer global require &#39;squizlabs/php_codesniffer=*&#39;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Changed current directory to /home/vagrant/.composer&#10;./composer.json has been updated&#10;Loading composer repositories with package information&#10;Updating dependencies (including require-dev)&#10;  - Installing squizlabs/php_codesniffer (2.3.4)&#10;    Downloading: 100%&#10;&#10;Writing lock file&#10;Generating autoload files</span><br></pre></td></tr></table></figure>
<p><strong>測試</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phpcs --version</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP_CodeSniffer version 2.3.4 (stable) by Squiz (http://www.squiz.net)</span><br></pre></td></tr></table></figure>
<p><strong>檢查PSR-2</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phpcs --standard=PSR2 Laravel/app</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>Laravel</code>為你的專案名稱，因為我們寫的code都在app目錄下，所以直接指定PHP Code Sniffer幫我們檢查<code>app</code>目錄下所有的<code>.php</code>檔案。</li>
<li>PHP Code Sniffer預設的coding style為PEAR，因為我們用的是<code>PSR-2</code>，所以要特別使用加上<code>--standard=PSR2</code>。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FILE: /home/vagrant/php-cs-test/app/User.php&#10;----------------------------------------------------------------------&#10;FOUND 3 ERRORS AFFECTING 3 LINES&#10;----------------------------------------------------------------------&#10; 13 | ERROR | [x] The first item in a multi-line implements list must&#10;    |       |     be on the line following the implements keyword&#10; 14 | ERROR | [x] Expected 4 spaces before interface name; 36 found&#10; 15 | ERROR | [x] Expected 4 spaces before interface name; 36 found&#10;----------------------------------------------------------------------&#10;PHPCBF CAN FIX THE 3 MARKED SNIFF VIOLATIONS AUTOMATICALLY&#10;----------------------------------------------------------------------&#10;&#10;Time: 255ms; Memory: 5.25Mb</span><br></pre></td></tr></table></figure>
<ul>
<li>若沒有任何違反PSR-2之處，將無任何回應，否則將出現類似如上的報表，告訴你哪個檔案有問題，錯在哪些地方。其中<code>FOUND</code>為行數。</li>
</ul>
<h3 id="php-cs-fixer">php-cs-fixer</h3><p><a href="http://cs.sensiolabs.org/" target="_blank" rel="external">PHP Coding Standards Fixer</a>簡稱 <strong><em>php-cs-fixer</em></strong>。雖然PHP Code Sniffer可以幫我們找出哪些code不符合PSR-2，若只有幾個檔案，我們手動改就可以，若檔案太多，就得依賴 <strong><em>php-cs-fixer</em></strong> 幫我們修正。<span class="margin-note-marker"><sup>7</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">7</span>將PHP Code Standrads Fixer安裝到Homestead或Mac本機都可以，安裝方式都一樣，若要搭配PhpStorm就要<code>一定</code>要安裝在Mac本機。</span></span></span></p>
<p><strong>安裝</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ composer global require fabpot/php-cs-fixer</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Changed current directory to /home/vagrant/.composer&#10;Using version ^1.10 for fabpot/php-cs-fixer&#10;./composer.json has been updated&#10;Loading composer repositories with package information&#10;Updating dependencies (including require-dev)&#10;  - Installing sebastian/diff (1.3.0)&#10;    Downloading: 100%&#10;&#10;  - Installing symfony/stopwatch (v2.7.4)&#10;    Downloading: 100%&#10;&#10;  - Installing symfony/finder (v2.7.4)&#10;    Downloading: 100%&#10;&#10;  - Installing symfony/filesystem (v2.7.4)&#10;    Downloading: 100%&#10;&#10;  - Installing symfony/event-dispatcher (v2.7.4)&#10;    Downloading: 100%&#10;&#10;  - Installing fabpot/php-cs-fixer (v1.10)&#10;    Downloading: 100%&#10;&#10;symfony/event-dispatcher suggests installing symfony/dependency-injection ()&#10;symfony/event-dispatcher suggests installing symfony/http-kernel ()&#10;Writing lock file&#10;Generating autoload files</span><br></pre></td></tr></table></figure>
<p><strong>測試</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ php-cs-fixer  --version</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP CS Fixer version 1.10 by Fabien Potencier</span><br></pre></td></tr></table></figure>
<p><strong>修正PSR-2</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ php-cs-fixer fix Laravel/app/ --level=psr2 --verbose</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>Laravel</code>為你的專案名稱，因為我們寫的code都在app目錄下，所以直接指定PHP-CS-Fixer幫我們檢查<code>app</code>目錄下所有的<code>.php</code>檔案。</li>
<li><code>--level=psr2</code>指定使用<code>PSR-2</code>標準來修正我們的code。</li>
<li><code>--verbose</code>表示PHP-CS-Fixer在執行時，會顯示出詳細的結果。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">......F......F......&#10;Legend: ?-unknown, I-invalid file syntax, file ignored, .-no changes, F-fixed, E-error&#10;   1) Http/Controllers/Controller.php (single_line_after_imports)&#10;   2) Http/routes.php (braces)&#10;Fixed all files in 1.066 seconds, 6.500 MB memory used</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Lengend</code>表示在執行時，所執行過的動作。</li>
<li>如上圖所示，表示修正過<code>Controller.php</code>與<code>routes.php</code>。</li>
</ul>
<h3 id="PhpStorm">PhpStorm</h3><p>PhpStorm對於PSR-2有以下支援 : </p>
<ol>
<li>內建支援PSR-2。</li>
<li>可外掛PHP Code Sniffer，讓我在寫code的同時就可提醒我們是否符合PSR-2。</li>
<li>可外掛PHP Coding Standards Fixer，將code修正為PSR-2。</li>
</ol>
<p><strong>支援PSR-2</strong><br><strong><em>Preferences -&gt; Editor -&gt; Code Style -&gt; PHP : Set from… -&gt; Predefined Style : PSR1/PSR2</em></strong><br><img src="/images/php/php-psr2/psr2007.png" alt=""></p>
<p><strong>設定 PSR-2 所沒規定的 Code Style</strong><br>如下圖所示，你可能會希望array的key與value能對齊，但這並不是PSR-2所規定的style，你可以自行設定。<br><img src="/images/php/php-psr2/psr2009.png" alt=""></p>
<p><strong>phpcs</strong><br><strong><em>Preferences -&gt; Languages &amp; Frameworks -&gt; PHP -&gt; Code Sniffer</em></strong><br><img src="/images/php/php-psr2/psr2000.png" alt=""></p>
<p>指定<strong>phpcs</strong>路徑 : <code>/Users/oomusou/.composer/vendor/bin/phpcs</code>。<span class="margin-note-marker"><sup>8</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">8</span>其中<code>/Users/oomusou/</code>為你的home directory。</span></span></span><br><img src="/images/php/php-psr2/psr2001.png" alt=""></p>
<p><strong><em>Preferences -&gt; Editor -&gt; Inspections</em></strong></p>
<ul>
<li>將PHP Code Sniffer validation<code>打勾</code>。</li>
<li>將Coding standard選<code>PSR2</code>。</li>
</ul>
<p><img src="/images/php/php-psr2/psr2002.png" alt=""></p>
<p><strong>php-cs-fixer</strong><br><strong><em>Preferences -&gt; Tools -&gt; External Tools</em></strong><br>按<code>+</code>新增<code>External Tools</code>。<br><img src="/images/php/php-psr2/psr2004.png" alt=""> </p>
<p><strong>Name</strong> : <code>php-cs-fixer</code><br><strong>Description</strong> : <code>Run php-cs on current file</code><br><strong>Program</strong> : <code>/Users/oomusou/.composer/vendor/bin/php-cs-fixer</code><span class="margin-note-marker"><sup>9</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">9</span>其中<code>/Users/oomusou/</code>為你的home directory。</span></span></span><br><strong>Parameters</strong> : <code>--level=psr2 --verbose fix $FileDir$/$FileName$</code><br><strong>Working Directory</strong> : <code>$ProjectFileDir$</code><br><img src="/images/php/php-psr2/psr2005.png" alt=""></p>
<p><strong>測試</strong><br><strong>測試內建的Reformat Code</strong></p>
<p>&#8963; + &#8997; + L : 重新整理Coding Style。<br>&#8963; + &#8997; + &#8679;+ L : 設定重新整理Coding Style方式。</p>
<ul>
<li><strong>Optimize imports</strong> : 沒用到的namespace，<code>use</code>會自動移除。</li>
<li><strong>Rearrange code</strong> : 會自動依據Code Style的Arrangement規格將code重新排序。</li>
</ul>
<p><img src="/images/php/php-psr2/psr2008.png" alt=""></p>
<p><strong>測試PHP Code Sniffer</strong><br><img src="/images/php/php-psr2/psr2003.png" alt=""></p>
<p><code>{</code>與<code>class</code>同一行，並不符合PSR-2建議，PhpStorm馬上在該行下方顯示<code>波浪紋</code>，並提示<code>phpcs: Openning brace of a class must be on the line after the definition</code>。</p>
<p><strong>測試PHP Coding Standards Fixer</strong><br><strong><em>Tools -&gt; External Tools -&gt; php-cs-fixer</em></strong><br>PHP Code Standards會幫我們的code修正成PSR-2所要求，並同時在下方顯示報告。<br><img src="/images/php/php-psr2/psr2006.png" alt=""></p>
<h2 id="Conclusion">Conclusion</h2><hr>
<ul>
<li>Function/Method與Class的<code>{</code>是否要<code>換行</code>比較爭議，不過既然PSR-2已經規定，建議遵循PSR-2。</li>
<li>經過實測結果，PHP Code Sniffer的要求會比PHP Coding Standards Fixer還嚴格，所以儘管跑過PHP Coding Standards Fixer之後，可能還需要手動修改一些地方才能通過PHP Code Sniffer。</li>
<li>PhpStorm內建的coding style已經支援PSR-2，與PHP Coding Standards Fixer的差異在於 : PhpStorm允許你微調自己的coding style，甚至可以加入PSR-2沒有規定的規則，而PHP Coding Standards Fixer則完全遵循PSR-2標準。</li>
<li>PhpStorm除了內建PSR-2外，還完美整合了PHP Code Sniffer與PHP Coding Standards Fixer，建議使用PhpStorm開發PHP。</li>
</ul>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/laravel/elixir/elixir-phpunit/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/tags"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/tdd/tdd-jaceju/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2015-09-23 
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/PHP/">PHP<span>15</span></a></li> <li><a href="/tags/PSR/">PSR<span>1</span></a></li> <li><a href="/tags/PhpStorm/">PhpStorm<span>20</span></a></li>
    </ul>
	</div>
		

    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer>  </footer>
</div> <!-- container-narrow -->
  
  <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hAXbiVYFC92XF16_EhCh','2.0.0');
  </script>



  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
   </html>
