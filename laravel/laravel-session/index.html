<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>深入探討 Laravel Session | 點燈坊</title>
  <meta name="author" content="真 OO無双">
  
  <meta name="description" content="各種使用 Session 使用方式介紹">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
 <meta name="description" content="各種使用 Session 使用方式介紹">
<meta property="og:type" content="article">
<meta property="og:title" content="深入探討 Laravel Session">
<meta property="og:url" content="http://oomusou.io/laravel/laravel-session/index.html">
<meta property="og:site_name" content="點燈坊">
<meta property="og:description" content="各種使用 Session 使用方式介紹">
<meta property="og:image" content="http://oomusou.io/images/feature/logo.png">
<meta property="og:updated_time" content="2016-07-13T03:47:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入探討 Laravel Session">
<meta name="twitter:description" content="各種使用 Session 使用方式介紹">
 

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
     <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		<li><a  href="/">點燈坊</a></li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 
	
		<div class="page-header">		
			<h1> 深入探討 Laravel Session</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div class="col-md-9">
	

	
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> 各種使用 Session 使用方式介紹			
		</div> <!-- alert -->
		

	<!-- toc -->
	<div id="postTOC">
		<span class="tocHeading">Contents</span>
		<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Version"><span class="toc-article-text">Version</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#常用_API"><span class="toc-article-text">常用 API</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#使用_Facade"><span class="toc-article-text">使用 Facade</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#使用_Helper"><span class="toc-article-text">使用 Helper</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#使用依賴注入"><span class="toc-article-text">使用依賴注入</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#各種實作"><span class="toc-article-text">各種實作</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#File"><span class="toc-article-text">File</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Cookie"><span class="toc-article-text">Cookie</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Database"><span class="toc-article-text">Database</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Redis"><span class="toc-article-text">Redis</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Array"><span class="toc-article-text">Array</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#各種實作比較"><span class="toc-article-text">各種實作比較</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Middleware"><span class="toc-article-text">Middleware</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Auth"><span class="toc-article-text">Auth</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Expiration"><span class="toc-article-text">Expiration</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#單元測試"><span class="toc-article-text">單元測試</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Conclusion"><span class="toc-article-text">Conclusion</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Sample_Code"><span class="toc-article-text">Sample Code</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Reference"><span class="toc-article-text">Reference</span></a></li></ol>
    </div>

	<!-- content -->
	<div class="mypage">		
	    <p>由於 HTTP 為 stateless，為了讓 Web 的狀態能跨 page 存取，就必須使用 session 機制。Laravel 提供單一 API，讓你不用修改程式碼，只要修改設定檔，就可以快速切換各種 session 實作，達成開放封閉原則要求，還特別考慮在單元測試下如何測試 session。</p>
<a id="more"></a>
<h2 id="Version">Version</h2><hr>
<p>PHP 7.0.0<br>Laravel 5.2.39</p>
<h2 id="常用_API">常用 API</h2><h3 id="使用_Facade">使用 Facade</h3><p><strong>SessionController.php</strong><span class="margin-note-marker"><sup>1</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">1</span>GitHub Commit : <a href="https://github.com/oomusou/Laravel52RefactorNamespace_demo/commit/9fa92fbedd7f367b12510dbeee10bdf8020338d9" target="_blank" rel="external">使用 Facade 讀寫 Session</a></span></span></span><br><figure class="highlight php"><figcaption><span>app/Http/Controllers/SessionController.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Requests</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Session</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SessionController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        Session::put(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>);</span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.put'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (Session::has(<span class="string">'MyName'</span>)) &#123;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">'name'</span>] = Session::get(<span class="string">'MyName'</span>);</span><br><span class="line">            Session::forget(<span class="string">'MyName'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.get'</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第 10 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Session::put(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>);</span><br></pre></td></tr></table></figure></p>
<p>使用 <code>Session::put()</code> 將值放進 session，其中第一個參數為 key，第二個參數為 value。</p>
<p>17 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Session::has(<span class="string">'MyName'</span>)</span><br></pre></td></tr></table></figure></p>
<p>判斷 session 是否存在，Laravel 預設存在於 server 時間為 2 個小時，所以可能因為 expire 掉而讀不到，所以在讀取時必須先使用 <code>Session::has()</code> 判斷 session 是否存在。</p>
<p>18 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span>[<span class="string">'name'</span>] = Session::get(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>使用 <code>Session::get()</code> 從 session 讀取，傳入參數為 key。</p>
<p>19 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Session::forget(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>若 session 使用過後不再使用，可使用 <code>Session::forget()</code> 將該 session 刪除。</p>
<p><strong>使用 Flash</strong><br>Session 常常用來跨 page 傳資料用，如在不同 page 顯示確認訊息，這種訊息只要顯示完，就沒有存在價值，可以使用 <code>Session::flash()</code>。</p>
<p><strong>SessionController.php</strong><span class="margin-note-marker"><sup>2</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">2</span>GitHub Commit : <a href="https://github.com/oomusou/Laravel52RefactorNamespace_demo/commit/9fa92fbedd7f367b12510dbeee10bdf8020338d9" target="_blank" rel="external">使用 Facade 的 Flash 讀寫 Session</a></span></span></span><br><figure class="highlight php"><figcaption><span>app/Http/Controllers/SessionController.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Requests</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Session</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SessionController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        Session::flash(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>);</span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.put'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (Session::has(<span class="string">'MyName'</span>)) &#123;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">'name'</span>] = Session::get(<span class="string">'MyName'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.get'</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>10 行<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="rule"><span class="attribute">Session</span>:<span class="value">:<span class="function">flash</span>(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>使用 <code>Session::flash()</code> 取代 <code>Session::put()</code>。</p>
<p>18 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span>[<span class="string">'name'</span>] = Session::get(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>只需使用 <code>Session::get()</code> 讀取資料即可，不需再使用 <code>Session::forget()</code> 刪除 session。</p>
<h3 id="使用_Helper">使用 Helper</h3><p><strong>SessionController.php</strong><span class="margin-note-marker"><sup>2</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">2</span>GitHub Commit : <a href="https://github.com/oomusou/Laravel52RefactorNamespace_demo/commit/9fa92fbedd7f367b12510dbeee10bdf8020338d9" target="_blank" rel="external">使用 Helper 讀寫 Session</a></span></span></span><br><figure class="highlight php"><figcaption><span>app/Http/Controllers/SessionController.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Requests</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Session</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SessionController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        session([<span class="string">'MyName'</span> =&gt; <span class="string">'Oomusou'</span>]);</span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.put'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> (session()-&gt;has(<span class="string">'MyName'</span>)) &#123;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">'name'</span>] = session(<span class="string">'MyName'</span>);</span><br><span class="line">            session()-&gt;forget(<span class="string">'MyName'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.get'</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第 10 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session([<span class="string">'MyName'</span> =&gt; <span class="string">'Oomusou'</span>]);</span><br></pre></td></tr></table></figure></p>
<p>相當於 <code>Session::put</code>，直接將陣列傳進 <code>session()</code>，陣列的 key 即為 session 的 key，陣列的 value 即為 session 的 value。</p>
<p>17 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session()-&gt;has(<span class="string">'MyName'</span>)</span><br></pre></td></tr></table></figure></p>
<p>相當於 <code>Session::has()</code>，直接傳入 session 的 key。</p>
<p>18 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span>[<span class="string">'name'</span>] = session(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>相當於 <code>Session::get()</code>，直接傳入 session 的 key。</p>
<p>19 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session()-&gt;forget(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>相當於 <code>Session::forget()</code>，直接傳入 session 的 key。</p>
<p>同理也可以使用 <code>session()-&gt;flash()</code> 取代 <code>Session::flash()</code>。</p>
<h3 id="使用依賴注入">使用依賴注入</h3><p><strong>SessionController.php</strong><span class="margin-note-marker"><sup>3</sup></span> <span class="block margin-div-outer"><span class="block margin-div-inner"><span class="block margin-note"><span class="margin-note-marker">3</span>GitHub Commit : <a href="https://github.com/oomusou/Laravel52RefactorNamespace_demo/commit/9fa92fbedd7f367b12510dbeee10bdf8020338d9" target="_blank" rel="external">使用依賴注入讀寫 Session</a></span></span></span><br><figure class="highlight php"><figcaption><span>app/Http/Controllers/SessionController.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Requests</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SessionController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span><span class="params">(Request <span class="variable">$request</span>)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="variable">$request</span>-&gt;session()-&gt;put(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>);</span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.put'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">(Request <span class="variable">$request</span>)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request</span>-&gt;session()-&gt;has(<span class="string">'MyName'</span>)) &#123;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="variable">$request</span>-&gt;session()-&gt;get(<span class="string">'MyName'</span>);</span><br><span class="line">            <span class="variable">$request</span>-&gt;session()-&gt;forget(<span class="string">'MyName'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view(<span class="string">'session.get'</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第 8 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span><span class="params">(Request <span class="variable">$request</span>)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="variable">$request</span>-&gt;session()-&gt;put(<span class="string">'MyName'</span>, <span class="string">'Oomusou'</span>);</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'session.put'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在 <code>put()</code> 使用 method injection 將 <code>Request</code> 物件注入進來，<code>$request</code> 的 <code>session()</code> 會回傳 session 物件，使用其 <code>put()</code> 寫入 session。</p>
<p>18 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$request</span>-&gt;session()-&gt;has(<span class="string">'MyName'</span>)</span><br></pre></td></tr></table></figure></p>
<p>依賴注入 <code>$request</code> 的 <code>session()</code> 會回傳的 session 物件，使用其 <code>has()</code> 判斷 session 是否存在。</p>
<p>19 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data</span>[<span class="string">'name'</span>] = <span class="variable">$request</span>-&gt;session()-&gt;get(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>依賴注入 <code>$request</code> 的 <code>session()</code> 會回傳的 session 物件，使用其 <code>get()</code> 讀取 session。</p>
<p>20 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$request</span>-&gt;session()-&gt;forget(<span class="string">'MyName'</span>);</span><br></pre></td></tr></table></figure></p>
<p>依賴注入 <code>$request</code> 的 <code>session()</code> 會回傳的 session 物件，使用其 <code>forget()</code> 刪除 session。</p>
<h2 id="各種實作">各種實作</h2><hr>
<h3 id="File">File</h3><p><strong>.env</strong><br><figure class="highlight php"><figcaption><span>.env</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">PP_ENV=local</span><br><span class="line">APP_DEBUG=<span class="keyword">true</span></span><br><span class="line">APP_KEY=base64:PHGtr3aQs2bu1C7q0uLYXKAYpuahwdx/<span class="number">9</span>dUnQvXWVFU=</span><br><span class="line">APP_URL=http:<span class="comment">//localhost</span></span><br><span class="line"></span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_HOST=localhost</span><br><span class="line">DB_PORT=<span class="number">3306</span></span><br><span class="line">DB_DATABASE=homestead</span><br><span class="line">DB_USERNAME=homestead</span><br><span class="line">DB_PASSWORD=secret</span><br><span class="line"></span><br><span class="line">CACHE_DRIVER=file</span><br><span class="line">SESSION_DRIVER=file</span><br><span class="line">QUEUE_DRIVER=sync</span><br><span class="line"></span><br><span class="line">REDIS_HOST=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">REDIS_PASSWORD=<span class="keyword">null</span></span><br><span class="line">REDIS_PORT=<span class="number">6379</span></span><br><span class="line"></span><br><span class="line">MAIL_DRIVER=smtp</span><br><span class="line">MAIL_HOST=mailtrap.io</span><br><span class="line">MAIL_PORT=<span class="number">2525</span></span><br><span class="line">MAIL_USERNAME=<span class="keyword">null</span></span><br><span class="line">MAIL_PASSWORD=<span class="keyword">null</span></span><br><span class="line">MAIL_ENCRYPTION=<span class="keyword">null</span></span><br></pre></td></tr></table></figure></p>
<p>14 行<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SESSION_DRIVER=file</span><br></pre></td></tr></table></figure></p>
<p>Laravel 預設將 session driver 的設定存在 <code>.env</code>。</p>
<p><code>file</code> 是 Laravel 預設的 session 實作方式，會將檔案存在 <code>storage/framework/sessions</code> 目錄下。</p>
<h3 id="Cookie">Cookie</h3><hr>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SESSION_DRIVER=cookie</span><br></pre></td></tr></table></figure>
<p>將 <code>.env</code> 的 <code>SESSION_DRIVER</code> 改成 <code>cookie</code>，即可改用 cookie 實作 session。</p>
<p>不過使用 cookie 將有以下幾點限制 :</p>
<ol>
<li>Cookie 有 4KB 大小限制。</li>
<li>Cookie 必須透過網路從瀏覽器端傳回 server。</li>
<li>使用者可以選擇不使用 cookie。</li>
<li>雖然 Laravel 有替 cookie 加密，但仍有淺在被修改的可能。</li>
</ol>
<p>至於程式碼則完全不用修改。</p>
<h3 id="Database">Database</h3><hr>
<h3 id="Redis">Redis</h3><hr>
<h3 id="Array">Array</h3><hr>
<h3 id="各種實作比較">各種實作比較</h3><hr>
<ul>
<li>Cookie : 存在 browser端，適合存 user preference</li>
<li>Sessio : 存在 server 端，會 expired，預設為2 hr，</li>
</ul>
<h2 id="Middleware">Middleware</h2><hr>
<h2 id="Auth">Auth</h2><hr>
<h2 id="Expiration">Expiration</h2><hr>
<h2 id="單元測試">單元測試</h2><hr>
<h2 id="Conclusion">Conclusion</h2><hr>
<h2 id="Sample_Code">Sample Code</h2><hr>
<p>完整的範例可以在我的 <a href="https://github.com/oomusou/" target="_blank" rel="external">GitHub</a> 上找到。</p>
<h2 id="Reference">Reference</h2><hr>
<p>Taylor Otwell, <a href="https://laravel.com/docs/master/session" target="_blank" rel="external">Session</a><br>Christophe Limpalair, <a href="https://scaleyourcode.com/blog/article/10" target="_blank" rel="external">Using Redis in Laravel</a></p>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/phpstorm/phpstorm-code-inspection/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/tags"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/tdd/tdd-collection-assertion/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
	
	<!-- comment -->
	
	
	</div> <!-- col-md-9/col-md-12 -->
	
	
		<div class="col-md-3"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2016-07-11 
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/Laravel/">Laravel<span>42</span></a></li>
    </ul>
	</div>
		

    <hr>
	
</div><!-- col-md-3 -->

	

</div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
  <footer>  </footer>
</div> <!-- container-narrow -->
  
  <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hAXbiVYFC92XF16_EhCh','2.0.0');
  </script>



  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
   </html>
